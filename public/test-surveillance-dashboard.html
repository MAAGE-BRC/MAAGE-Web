<!DOCTYPE html>
<html>
<head>
    <title>Genome Surveillance Dashboard Test</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Load ECharts globally -->
    <script src="/maage/js/echarts/v5.4.3/echarts.js"></script>
    
    <!-- Load CSS -->
    <link rel="stylesheet" href="/js/p3/resources/p3.css">
    <link rel="stylesheet" href="/maage/css/dist/maage.css">
    
    <!-- Load Dojo -->
    <script type="text/javascript">
        window.dojoConfig = {
            baseUrl: '/js/',
            async: true,
            packages: [
                { name: 'p3', location: 'p3' },
                { name: 'dijit', location: 'dijit' },
                { name: 'dojo', location: 'dojo' },
                { name: 'dojox', location: 'dojox' },
                { name: 'echarts', location: 'echarts' }
            ]
        };
        
        // Mock App object
        window.App = {
            dataAPI: window.location.origin + '/api',
            authorizationToken: null
        };
    </script>
    <script src="/js/dojo/dojo.js"></script>
    
    <style>
        body {
            margin: 20px;
            padding: 0;
            font-family: sans-serif;
        }
        h1 {
            color: #333;
            margin-bottom: 20px;
        }
        #dashboardContainer {
            width: 100%;
            height: 800px;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 10px;
        }
    </style>
</head>
<body class="maage">
    <h1>Genome Surveillance Dashboard Test</h1>
    
    <div id="dashboardContainer"></div>
    
    <script type="text/javascript">
        require([
            'p3/widget/GenomeSurveillanceDashboard',
            'dojo/domReady!'
        ], function(GenomeSurveillanceDashboard) {
            console.log('Creating surveillance dashboard...');
            
            // Create the dashboard widget
            var dashboard = new GenomeSurveillanceDashboard({
                // Test with a simple query for all genomes
                query: 'eq(public,true)'
            }, 'dashboardContainer');
            
            dashboard.startup();
            
            console.log('Dashboard created:', dashboard);
        });
    </script>
</body>
</html>