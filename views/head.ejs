<% if (request && request.applicationOptions.gaID) { %>
<script async src="https://www.googletagmanager.com/gtag/js?id=<%- request.applicationOptions.gaID %>"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() { dataLayer.push(arguments); }
  gtag('js', new Date());

  gtag('config', '<%- request.applicationOptions.gaID %>', {
    'link_attribution': true
  });
</script>
<% } %>

<% if (request && request.applicationOptions.MSClarityID) { %>
<script type="text/javascript">
  (function (c, l, a, r, i, t, y) {
    c[a] = c[a] || function () { (c[a].q = c[a].q || []).push(arguments) };
    t = l.createElement(r); t.async = 1; t.src = "https://www.clarity.ms/tag/" + i;
    y = l.getElementsByTagName(r)[0]; y.parentNode.insertBefore(t, y);
  })(window, document, "clarity", "script", "<%- request.applicationOptions.MSClarityID %>");
</script>
<% } %>

<%
	const load_css = [
		"p3/resources/p3.css",
		"heatmap/dist/hotmap.css",
	];
%>
<% if (request && request.production) { %>
<% load_css.forEach(function(url) { %>
<link rel='stylesheet' href="/js/<%- request.package.version %>/<%- url %>" />
<% }) %>
<% } else { %>
<% load_css.forEach(function(url) { %>
<link rel='stylesheet' href="/js/<%- url %>" />
<% }) %>
<% } %>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;1,100;1,200;1,300;1,400;1,500;1,600;1,700&family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap">

<script src="/maage/js/echarts/v5.4.3/echarts.js"></script>
<script src="/maage/js/echarts/themes/maage.js"></script>
<script src="/maage/js/data-api/maage_client.js"></script>
<script src="/maage/js/chart-widget-base.js"></script>
<script>
    // Initialize MAAGE client globally
    if (typeof MAAGEClient !== 'undefined') {
        window.maageSVC = new MAAGEClient();
        window.maageSVC.init('https://www.maage-brc.org/api');
        
        // Test connection and log status
        window.maageSVC.getSchema('genome').then(function(schema) {
            console.log('MAAGE Client initialized successfully:', schema);
        }).catch(function(error) {
            console.warn('MAAGE Client connection issue:', error);
        });
        
        console.log('MAAGE Client available:', {
            client: !!window.maageSVC,
            initialized: window.maageSVC.initialized,
            endpoint: window.maageSVC.endpoint
        });
    } else {
        console.error('MAAGEClient class not found - check if maage_client.js loaded properly');
    }
</script>

<link rel="stylesheet" href="/maage/gridstack/gridstack.min.css">
<link rel="stylesheet" href="/maage/css/dist/maage.css">
<link rel="stylesheet" href="/maage/css/src/styles.css">

<script src="https://cdn.tailwindcss.com"></script>