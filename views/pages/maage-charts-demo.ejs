<!DOCTYPE html>
<html lang="en">
  <head>
    <title>MAAGE Charts Demo | MAAGE</title>
    <%- include('../head') %>
  </head>
  <body class="claro patric bg-maage-bg <% if (request.isAuthenticated && request.isAuthenticated()) { %>Authenticated<% } %>">
    <div id="ApplicationContainer" data-dojo-type="dijit/layout/BorderContainer" class="layoutContainer" data-dojo-props="id:'ApplicationContainer',gutters:false,liveSplitters:false">
      <%- include('../navbar') %>
      <div data-dojo-type="dijit/layout/ContentPane" data-dojo-props="region:'center'" style="padding:0px;border:0px solid #ddd;background:inherit;">
        <div id="bv-brc-page">
          <div id="bv-brc-page-container" style="width:100%;">
            <div class="page-content" style="width:95%; margin: 0 auto; text-align:left;">
              <div class="max-w-full mx-auto">
                
                <!-- Header Section -->
                <div class="mb-8 mt-6">
                  <h1 class="text-3xl font-bold text-maage-text-primary mb-4">MAAGE Charts Demo</h1>
                  <p class="text-lg text-maage-text-muted mb-6">
                    Interactive Apache ECharts widgets integrated with MAAGE data API for genomic data visualization.
                    Each chart supports both chart and table views with clickable navigation.
                  </p>
                  
                  <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                    <h3 class="text-lg font-medium text-blue-900 mb-2">Features</h3>
                    <ul class="text-blue-800 space-y-1">
                      <li>‚Ä¢ <strong>MAAGE API Integration:</strong> Uses global maageSVC client with fallback to XHR</li>
                      <li>‚Ä¢ <strong>Interactive Charts:</strong> Click on data points to navigate to filtered genome views</li>
                      <li>‚Ä¢ <strong>Chart/Table Toggle:</strong> Switch between visualization and tabular data views</li>
                      <li>‚Ä¢ <strong>Responsive Design:</strong> Charts automatically resize and use MAAGE theme colors</li>
                      <li>‚Ä¢ <strong>Configurable:</strong> Facet fields, queries, and display options are customizable</li>
                    </ul>
                  </div>
                </div>

                <!-- Controls Section -->
                <div class="flex justify-between items-center mb-6 p-4 bg-maage-bg-subtle rounded-lg">
                  <div>
                    <h2 class="text-xl font-semibold text-maage-text-primary mb-2">Dashboard Controls</h2>
                    <p class="text-sm text-maage-text-muted">Toggle edit mode to rearrange and resize chart widgets</p>
                  </div>
                  <div class="flex items-center gap-3">
                    <span id="edit-mode-label" class="text-sm font-medium text-gray-700">View Mode</span>
                    <label for="toggle-drag" class="sr-only">Mode</label>
                    <button id="toggle-drag" type="button" class="relative inline-flex h-6 w-11 shrink-0 cursor-pointer rounded-full border-2 border-transparent bg-gray-200 transition-colors duration-200 ease-in-out" role="switch" aria-checked="false">
                      <span class="sr-only">Edit mode toggle</span>
                      <span id="toggle-indicator" aria-hidden="true" class="pointer-events-none inline-block size-5 translate-x-0 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out"></span>
                    </button>
                  </div>
                </div>

                <!-- Charts Grid -->
                <% const widgets = [
                  { partial: 'maage-bar-chart.ejs', x: 0, y: 0, w: 4, h: 3 },
                  { partial: 'maage-doughnut-chart.ejs', x: 4, y: 0, w: 4, h: 3 },
                  { partial: 'maage-line-chart.ejs', x: 8, y: 0, w: 4, h: 3 },
                  { partial: 'maage-species-chart.ejs', x: 0, y: 3, w: 6, h: 4 },
                  { partial: 'maage-genome-length-chart.ejs', x: 6, y: 3, w: 6, h: 4 },
                  { partial: 'maage-status-chart.ejs', x: 0, y: 7, w: 12, h: 3 }
                ]; %>

                <%- include('../components/gridstack-container', { widgets }) %>
                <%- include('../components/gridstack-init') %>

                <!-- Documentation Section -->
                <div class="mt-12 mb-8">
                  <h2 class="text-2xl font-bold text-maage-text-primary mb-4">Implementation Details</h2>
                  
                  <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="bg-white rounded-lg border border-maage-border p-6">
                      <h3 class="text-lg font-semibold text-maage-text-primary mb-3">üìä Bar Chart</h3>
                      <p class="text-sm text-maage-text-muted mb-3">Horizontal bar chart for categorical data distribution</p>
                      <div class="space-y-2 text-xs">
                        <p><strong>Data Source:</strong> isolation_source facets</p>
                        <p><strong>Chart Type:</strong> Horizontal bar chart</p>
                        <p><strong>Use Case:</strong> Isolation sources, sample origins</p>
                      </div>
                    </div>
                    
                    <div class="bg-white rounded-lg border border-maage-border p-6">
                      <h3 class="text-lg font-semibold text-maage-text-primary mb-3">üç© Doughnut Chart</h3>
                      <p class="text-sm text-maage-text-muted mb-3">Circular chart for proportional data visualization</p>
                      <div class="space-y-2 text-xs">
                        <p><strong>Data Source:</strong> geographic_group facets</p>
                        <p><strong>Chart Type:</strong> Doughnut/pie chart</p>
                        <p><strong>Use Case:</strong> Geographic groups, host classifications</p>
                      </div>
                    </div>
                    
                    <div class="bg-white rounded-lg border border-maage-border p-6">
                      <h3 class="text-lg font-semibold text-maage-text-primary mb-3">üìà Line Chart</h3>
                      <p class="text-sm text-maage-text-muted mb-3">Temporal data visualization with trend analysis</p>
                      <div class="space-y-2 text-xs">
                        <p><strong>Data Source:</strong> collection_year facets</p>
                        <p><strong>Chart Type:</strong> Area line chart</p>
                        <p><strong>Use Case:</strong> Submission timelines, temporal trends</p>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Usage Instructions -->
                <div class="bg-gray-50 rounded-lg p-6 mb-8">
                  <h3 class="text-lg font-semibold text-maage-text-primary mb-3">Usage Instructions</h3>
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                      <h4 class="font-medium text-maage-text-primary mb-2">In EJS Templates:</h4>
                      <pre class="bg-gray-100 p-3 rounded text-xs overflow-x-auto"><code>&lt;%- include('../widgets/maage-bar-chart.ejs') %&gt;</code></pre>
                    </div>
                    <div>
                      <h4 class="font-medium text-maage-text-primary mb-2">In Dojo Applications:</h4>
                      <pre class="bg-gray-100 p-3 rounded text-xs overflow-x-auto"><code>require(['p3/widget/maage/MAAGEBar'], function(MAAGEBar) {
  var widget = new MAAGEBar({
    chartTitle: 'Custom Title',
    facetField: 'your_field',
    query: 'your_solr_query'
  }, 'target-node');
  widget.startup();
});</code></pre>
                    </div>
                  </div>
                </div>

              </div>
            </div>
          </div>
        </div>
      </div>
      <%- include('../footer') %>
    </div>
    <%- include('../javascript') %>
  </body>
</html>